[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "BEPIDL Study - Notes",
    "section": "",
    "text": "Welcome! I’m Heli, a data analyst at Drexel Urban Health Collaborative, and this is home of the notes from Built Environment, Pedestrian Injuries and Deep Learning (BEPIDL) Study, a project led by Dr. Alex Quistberg and funded by NIH. You can find out more about the project on the NIH website."
  },
  {
    "objectID": "posts/Calles_var/calles_var.html",
    "href": "posts/Calles_var/calles_var.html",
    "title": "Street Level Variables",
    "section": "",
    "text": "From the first look, the street-level variables names in Calles_datos/ seemed a bit confusing, but after cross-referencing the codebook with CRUCES_DATOS.xlsx and variables in siniestros/, we have gained a much better understanding of what they mean. The column names in Calles_datos/and their corresponding description from the codebook are organized into codebook_calles-var.xlsx for future reference (there’re also a few uncertain variables to be confirmed/better defined).\nIn this post, we’ll describe the data cleaning process and explore the distributions of the variables related to road infrastructure at the street level."
  },
  {
    "objectID": "posts/Calles_var/calles_var.html#data-cleaning",
    "href": "posts/Calles_var/calles_var.html#data-cleaning",
    "title": "Street Level Variables",
    "section": "Data Cleaning",
    "text": "Data Cleaning\nAs mentioned in the first look, the data included in Calles_datos/ is a geo-referenced table with 100,819 street units (rows) and 66 attributes (columns, including street id and variables).\nIf we look at the histogram of total area and roadway area, we’ll see there’re a lot of very small streets with area close to 0, which may not be very useful for our downstream analysis.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\n\n\n\n\nCode\ncalle %&gt;% \n  as.data.frame() %&gt;% \n  select(CodigoCL,total_area = area, roadway_area = A_Calzada) %&gt;% \n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\", binwidth = 50)+\n  theme_minimal()+\n  facet_wrap(~variables)+\n  labs(title = \"Distribution of Street-level Roadway and Total Areas\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 13),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\nSorting the roadway area in ascending order, and zooming in on the smallest side, we take the first 500 rows (street units) of data:\n\n\nCode\ncalle %&gt;% \n    as.data.frame() %&gt;% \n    select(CodigoCL,total_area = area, roadway_area = A_Calzada) %&gt;% \n    arrange(total_area) %&gt;% \n    slice(1:500) %&gt;% \n    pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n    ggplot(aes(x=value)) +\n      geom_histogram(fill = \"skyblue\", color = \"blue\", binwidth = 0.5)+\n      theme_minimal()+\n      facet_wrap(~variables)+\n  labs(title = \"Distribution of Street-level Roadway and Total Areas\",\n    subtitle = \"for 500 street units with the smallest roadways\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\"),\n    plot.subtitle = element_text(size = 13)\n  )\n\n\n\nIf we leave out the values that are too small, for example here we’re choosing anything below 5m2, the 500 street units with the smallest roadways will look like this:\n\n\nCode\ncalle %&gt;% \n    as.data.frame() %&gt;% \n    select(CodigoCL,total_area = area, roadway_area = A_Calzada) %&gt;% \n    filter(roadway_area &gt; 5 ) %&gt;% \n    arrange(total_area) %&gt;% \n    slice(1:500) %&gt;% \n    pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n    ggplot(aes(x=value)) +\n    geom_histogram(fill = \"skyblue\", color = \"blue\", binwidth = 0.5)+\n    theme_minimal()+\n    facet_wrap(~variables)+\n  labs(title = \"Distribution of Street-level Roadway and Total Areas\",\n    subtitle = expression(\"for 500 street units with the smallest roadways &gt;5\"* m^2))+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\"),\n    plot.subtitle = element_text(size = 13)\n  )\n\n\n\nAt this point, our dataset went from 100,819 rows to 99,560 rows. I included one extra step here in an attempt to clean it further, by adding all the numeric columns for each row (except the ones for id, area-related and speed limit) and leaving out the rows that have a sum of less than 1. Considering most of the variables are counts of certain features, this step will remove the street units that have almost none of the feature that we’re studying. The resulting table now has 99,533 rows.\nIn addition, we’re also removing the columns that contain arbitrary IDs, repeated labels, summarization columns (that add up certain columns), and a few uncertain variables. For the character column sent_vial , we are recoding “uno” and “doble” to the numeric value 1 and 2, and set “SinD*” (no assigned direction) as numeric value 0.\n\n\nCode\ncalle_clean &lt;- calle %&gt;%\n  filter(A_Calzada &gt; 5) %&gt;%\n  select(\n    -c(CODIGO_IDE,\n      FID_EP_IND,\n      Etiquetas,\n      Etiqueta_1,\n      sen_v_inv,\n      comp_cl,\n      OID_,\n      Total_gene,\n      Total_ge_1)\n  ) %&gt;%\n  mutate(total = rowSums(pick(\n    where(is.numeric),\n    -c(sent_vial,\n      puente_vh,\n      Puente_PT,\n      velcidad,\n      area,\n      A_Calzada,\n      CodigoCL)\n  ))) %&gt;% #99560row\n  ##much much faster, see rowwise ops with dplyr\n  filter(total &gt;= 1) %&gt;% #99533rows\n  select(-total) %&gt;%\n  mutate(sent_vial = case_match(sent_vial, \"uno\" ~ 1, \"doble\" ~ 2, \"SinD*\" ~ 0))"
  },
  {
    "objectID": "posts/Calles_var/calles_var.html#variables-about-road-features",
    "href": "posts/Calles_var/calles_var.html#variables-about-road-features",
    "title": "Street Level Variables",
    "section": "Variables about Road Features",
    "text": "Variables about Road Features\nFor better visualization, we’re (again, loosely) categorizing the variables into several groups, based on the common domains used with road infrastructure features. Below is the domain and the variables involved:\n\nRoad Geometry: AVE_pendie, A_Calzada, P_Ancho_Cl, A_separado, A_andenes, sum_carril;\nSignage and Markings: sen_horizo , se_hor_seg , sen_vert , semaforo, X1_girar_iz , X5policiasa , X6pare , X7estaciona , X8zonas_esc , X9ceder_el;\nTraffic Flow and Patterns: segme_via, velcidad, sent_vial;\nPedestrian Infrastructure: Puente_PT, A_andenes, peatonale\nCycling Infrastructure: largo_cicl, X2_ciclov.;\nPublic Transportation: Rutas_TRM, Rutas_SITP, Parad_SITP, Caril_SITP, X3bus_o_Tra;\nLandscaping: arboles.\n\n\n\nCode\nroad_geo &lt;- c(\"AVE_pendie\", \"A_Calzada\", \"P_Ancho_Cl\",\n  \"A_separado\", \"A_andenes\",\"sum_carril\") \n#not including \"av_carrile\"\n\nsign1 &lt;- c(\"sen_horizo\",\"se_hor_seg\",\"sen_vert\", \"semaforo\")\nsign2 &lt;- c(\"X1_girar_iz\", \"X5policiasa\", \"X6pare\", \n  \"X7estaciona\", \"X8zonas_esc\", \"X9ceder_el\")\n\nflow &lt;- c(\"segme_via\", \"velcidad\", \"sent_vial\")\n\nped &lt;- c(\"A_andenes\", \"X4peatonale\")\n\nbike &lt;- c(\"largo_cicl\",\"X2_ciclov.\")\n\ntransit &lt;- c(\"Rutas_TRM\",\"Rutas_SITP\", \"Parad_SITP\",  \n  \"Caril_SITP\",\"X3bus_o_Tra\")\n\nlandsc &lt;- c(\"arboles\")\n\n\nBelow are the distribution of the variables in each domain:\n\nRoad Geometry\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(road_geo)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\")+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of Street-level Road Geometry Features\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nSignage and Markings\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(sign1)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\")+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of Street-level Signage Features\",\n    subtitle = \"Part 1\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(sign2)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\")+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of Street-level Signage Features\",\n    subtitle = \"Part 2\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nTraffic Flow and Patterns\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(flow)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\", binwidth = 1)+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of Street-level Features on Traffic Flow\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nPedestrian and Cycling Infrastructure\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(ped), all_of(bike)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\")+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of Street-level Pedestrian and Cycling Features\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 12),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\"))\n\n\n\n\n\n\n\nLandscaping\n\n\nCode\ncalle_clean_df %&gt;% \n  select(CodigoCL, all_of(landsc)) %&gt;%\n  pivot_longer(-CodigoCL, names_to = \"variables\") %&gt;% \n  ggplot(aes(x=value)) +\n  geom_histogram(fill = \"skyblue\", color = \"blue\")+\n  theme_minimal()+\n  facet_wrap(~variables, scales = \"free\")+\n  labs(title = \"Distribution of ST-level Landscaping Features\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    strip.text = element_text(size = 11),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 12, face = \"bold\", hjust = 0))"
  },
  {
    "objectID": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html",
    "href": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html",
    "title": "Initial exploratory data analysis of BEPIDL data",
    "section": "",
    "text": "In this report, my goal is to get familiar with the variables (indicators), what they represent (according to codebook), how complete the datasets are, and potentially examine the distribution of the variables."
  },
  {
    "objectID": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html#zat-level",
    "href": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html#zat-level",
    "title": "Initial exploratory data analysis of BEPIDL data",
    "section": "ZAT level",
    "text": "ZAT level\nAt ZAT level, two files (folders) are included (along with the codebook).\n\nZAT.zip: boundary files – a table of 1141 rows, 6 cols (each row being a ZAT unit);\nIntersections/ZAT_INDICADORES.xlsx: a table of 919 rows, 18 cols (each row being a ZAT unit).\n\n\nZAT folder\nTo begin with, I looked at the ZAT folder, which contains shapefiles that define boundaries of each ZAT zone.\n\n\nCode\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(sf)\nlibrary(leaflet)\n\nzat &lt;- st_read(\"../../../../data/ZAT/ZAT_geo/ZAT.shp\")\n\n\nReading layer `ZAT' from data source \n  `/Users/hx83/Documents/GitHub/BEPIDL/data/ZAT/ZAT_geo/ZAT.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1141 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: -74.88439 ymin: 3.70344 xmax: -73.05211 ymax: 5.83076\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  GCS_MAGNA\n\n\nCode\nzat\n\n\nSimple feature collection with 1141 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: -74.88439 ymin: 3.70344 xmax: -73.05211 ymax: 5.83076\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  GCS_MAGNA\nFirst 10 features:\n         Area MUNCod NOMMun ZAT UTAM                       geometry\n1  1366816039      0   &lt;NA&gt; 810  N/A MULTIPOLYGON Z (((-74.08207...\n2   824419773      0   &lt;NA&gt; 809  N/A MULTIPOLYGON Z (((-74.05947...\n3  1823077343      0   &lt;NA&gt; 823  N/A MULTIPOLYGON Z (((-73.64757...\n4   929997085      0   &lt;NA&gt; 822  N/A MULTIPOLYGON Z (((-73.54534...\n5  1409253432      0   &lt;NA&gt; 821  N/A MULTIPOLYGON Z (((-73.59517...\n6  1085719093  11001 Bogotá 796 UPR3 MULTIPOLYGON Z (((-74.08374...\n7  1820638886      0   &lt;NA&gt; 800  N/A MULTIPOLYGON Z (((-74.30147...\n8  1503956580      0   &lt;NA&gt; 811  N/A MULTIPOLYGON Z (((-74.49689...\n9  2349669218      0   &lt;NA&gt; 820  N/A MULTIPOLYGON Z (((-73.99614...\n10 1322014504      0   &lt;NA&gt; 812  N/A MULTIPOLYGON Z (((-74.4526 ...\n\n\nCode\nzat %&gt;%\n  st_zm() %&gt;% \n  leaflet() %&gt;%\n  addTiles() %&gt;%\n  leaflet::addPolygons()\n\n\n\n\n\n\n\n\nZAT_INDICADORES\nNext, we’re looking at the ZAT_INDICADORES.xlsx table. From referencing the codebook, I noticed the indicators in this table seem to be the “old” version. For all the ZAT included, there are no missing data, while some of the values are zeros. Here we are showing the distribution of all the indicators in the table, grouped into three categories (loosely tentatively): features about public transit, road and traffic lights.\n\nPublic transit\n\n\nCode\nzat_data &lt;- read_xlsx(\"../../../../data/ZAT/ZAT_INDICADORES.xlsx\")\n\nzat_data_long &lt;- zat_data %&gt;% \n  select(-2, -3) %&gt;% \n  pivot_longer(-ZAT, names_to = \"indicator\")\n\nbus &lt;- c('BUSTOPDENS', 'NUMRBP', 'LONGRBP', 'NUMRT', 'LONGRT')\nonroad &lt;- c('LONGMV', 'LRDENS', 'BPRDRATE', 'NUMINT', 'INTDENS')\ntlight &lt;- c('NUMTTFLIGH', 'NUMPTFLIGH')\nbyroad &lt;- c('NUMTTREES', 'NUMSTTREES', 'NUMBRIDGES')\n  \nzat_data_long %&gt;% \n  filter(indicator%in%all_of(bus)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\")+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal() +\n  labs(title = \"Distribution of Indicators related to Bus/BRT\")\n\n\n\n\n\n\n\nRoad features\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(onroad)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\")+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators related to Features on the Road\")\n\n\n\n\n\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(byroad)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\", alpha = 0.7)+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators related to Features by the Road\")\n\n\n\n\n\n\n\nTraffic lights\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(tlight)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\", alpha = 0.7)+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators about Traffic Lights\")"
  },
  {
    "objectID": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html#street-level",
    "href": "posts/EDA1_1st_look_var/EDA1_1st_look_var.html#street-level",
    "title": "Initial exploratory data analysis of BEPIDL data",
    "section": "Street level",
    "text": "Street level\nSo far, the data folder included is:\n\nCalles_datos/\n\nThis is a geo-referenced data table containing qualitative and quantitative data at the street level. Due to the size of the table, we are taking first 1000 rows to take a look at the geometry:\n\n\nCode\ncalles_1000 &lt;- readRDS(\"../../../../data/Calles/calles_1000.rds\")\n\ncalles_1000 %&gt;% \n  leaflet() %&gt;% \n  addTiles() %&gt;% \n  leaflet::addPolygons()\n\n\n\n\n\n\nApart from the geometry information, there are many variables included in the table, and the variable names do not seem to be in codebook. Skimming the full table:\n\n\nCode\nlibrary(reactable)\n\nskim_calles &lt;- read_csv(\"../../../../analysis/skim_calles.csv\") %&gt;% \n  select(-1) %&gt;% \n  rename(col_type = skim_type,\n         col_names = skim_variable)\n         \nreactable(skim_calles) \n\n\n\n\n\n\n\nIn the initial skimming report above, the types of all 67 columns, mean/sd and distribution (for numeric columns) are shown. While the completion rate of the columns seem high, some of the columns have many zeros, with 75% percentile =0."
  },
  {
    "objectID": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html",
    "href": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html",
    "title": "Exploratory data analysis 2 of BEPIDL data",
    "section": "",
    "text": "Building on the initial exploratory data analysis on variable distribution, I’d like to join the spatial information from ZAT folder with the variables from ZAT_INDICADORES.xlsx and visualize the geo-referenced data."
  },
  {
    "objectID": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#files-included",
    "href": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#files-included",
    "title": "Exploratory data analysis 2 of BEPIDL data",
    "section": "Files included",
    "text": "Files included\n\nZAT/\nThis folder contains boundary files for the ZAT units – a table of 1141 rows, 6 cols (each row being a ZAT unit); (dropping z dimension to create interactive maps).\n\n\nCode\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(sf)\nlibrary(leaflet)\n\nzat &lt;- st_read(\"../../../../data/ZAT/ZAT_geo/ZAT.shp\")\n\n\nReading layer `ZAT' from data source \n  `/Users/hx83/Documents/GitHub/BEPIDL/data/ZAT/ZAT_geo/ZAT.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1141 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: -74.88439 ymin: 3.70344 xmax: -73.05211 ymax: 5.83076\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  GCS_MAGNA\n\n\nCode\nzat %&gt;%\n  st_zm() %&gt;% \n  leaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Voyager) %&gt;%\n  addPolygons()\n\n\n\n\n\n\n\n\nZAT_INDICADORES.xlsx\nThis is a data table of 919 rows, 18 cols (each row being a ZAT unit).\nAccording to the codebook, the indicators in this table seem to be the “old” version. For all the ZAT included, there are no missing data, while some of the values are zeros. As seen from the row count, it contains fewer ZAT units than the shapefiles. (first 10 rows shown below)\n\n\nCode\nzat_data &lt;- read_xlsx(\"../../../../data/ZAT/ZAT_INDICADORES.xlsx\")\nzat_data[1:10,]\n\n\n# A tibble: 10 × 18\n     ZAT `Area M2` areakm2 BUSTOPDENS LONGMV LRDENS BPRDRATE NUMINT INTDENS\n   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;\n 1    83  1016244.   1.02       13.8  10852. 10679.   0         100   98.4 \n 2   854   219816.   0.220      18.2   1391.  6330.   0          21   95.5 \n 3    57   513564.   0.514      35.0   6935. 13504.   0          99  193.  \n 4    20   217888.   0.218      18.4   3586. 16460.   0          40  184.  \n 5    18   162708.   0.163      24.6   1083.  6655.   0           6   36.9 \n 6    19   228574.   0.229       0        0      0    0           0    0   \n 7    84   239887.   0.240       0      759.  3163.   0           5   20.8 \n 8   559  1184382.   1.18        0      167.   141.   0           2    1.69\n 9   561   807833.   0.808       3.71 10939. 13542.   0.0603    159  197.  \n10   947   916149.   0.916       8.73 17013. 18570.   0.0677    216  236.  \n# ℹ 9 more variables: NUMTTREES &lt;dbl&gt;, NUMSTTREES &lt;dbl&gt;, NUMBRIDGES &lt;dbl&gt;,\n#   NUMTTFLIGH &lt;dbl&gt;, NUMPTFLIGH &lt;dbl&gt;, NUMRBP &lt;dbl&gt;, LONGRBP &lt;dbl&gt;,\n#   NUMRT &lt;dbl&gt;, LONGRT &lt;dbl&gt;"
  },
  {
    "objectID": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#joining-geometry-with-data",
    "href": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#joining-geometry-with-data",
    "title": "Exploratory data analysis 2 of BEPIDL data",
    "section": "Joining Geometry with Data",
    "text": "Joining Geometry with Data\nHere we’ll join the ZAT shapefiles with the ZAT_INDICADORES.xlsx by ZAT ID, keeping the ZAT units that we have data for, resulting in a table of 919 rows and 23 columns.\n\n\nCode\ngeoref_zat &lt;- zat_data %&gt;% \n  left_join(zat, by = \"ZAT\") %&gt;% \n  st_as_sf()"
  },
  {
    "objectID": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#visualizing-indicators-in-maps",
    "href": "posts/EDA2_georef_ZAT/EDA2_georef_ZAT.html#visualizing-indicators-in-maps",
    "title": "Exploratory data analysis 2 of BEPIDL data",
    "section": "Visualizing Indicators in Maps",
    "text": "Visualizing Indicators in Maps\nWe’ll use the georeferenced data to visualize the indicators in maps (dropping z dimension, datum set to WGS84). With loose categorizing the variables into 3 groups: public transits, road features and traffic lights, we’ll show interactive maps for one variable for each group along with distributions of all variables.\n\nPublic transit\n\n\nCode\nlibrary(glue)\n# set color palette for circles\npal &lt;- colorNumeric(\n  palette = c(\"orange\",\"navy\"),\n  domain = georef_zat$BUSTOPDENS\n)\n\nzat_label &lt;- glue(\"ZAT{georef_zat$ZAT} Bus stop density: {round(georef_zat$BUSTOPDENS,2)}/km2\")\n\ngeoref_zat %&gt;%\n  st_zm() %&gt;%\n  st_transform(crs = st_crs(\"+proj=longlat +datum=WGS84\")) %&gt;%\n  leaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Voyager)  %&gt;%\n  addPolygons(color = \"white\", \n              weight = 0.5,\n              smoothFactor = 0.5,\n              opacity = 1,\n              fillColor = ~pal(BUSTOPDENS),\n              fillOpacity = 0.8,\n              highlightOptions = highlightOptions(\n                weight = 5,\n                color = \"#666\",\n                fillOpacity = 0.8,\n                bringToFront = TRUE),\n              label = zat_label,\n              labelOptions = labelOptions(\n                style = list(\n                  \"font-family\" = \"Fira Sans, sans-serif\",\n                  \"font-size\" = \"1.2em\"\n                ))\n              ) %&gt;% \n  addLegend(\"bottomleft\",\n            pal = pal,\n            values = ~BUSTOPDENS,\n            title = \"Bus Stop Density in Bogotá&lt;/br&gt;(ZAT-level)\",\n            opacity = 1)\n\n\n\n\n\n\n\n\n\n\n\nCode\nzat_data_long &lt;- zat_data %&gt;% \n  select(-2, -3) %&gt;% \n  pivot_longer(-ZAT, names_to = \"indicator\")\n\nbus &lt;- c('BUSTOPDENS', 'NUMRBP', 'LONGRBP', 'NUMRT', 'LONGRT')\nonroad &lt;- c('LONGMV', 'LRDENS', 'BPRDRATE', 'NUMINT', 'INTDENS')\ntlight &lt;- c('NUMTTFLIGH', 'NUMPTFLIGH')\nbyroad &lt;- c('NUMTTREES', 'NUMSTTREES', 'NUMBRIDGES')\n  \nzat_data_long %&gt;% \n  filter(indicator%in%all_of(bus)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\")+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal() +\n  labs(title = \"Distribution of Indicators related to Bus/BRT\")+\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nRoad features\n\n\nCode\npal2 &lt;- colorNumeric(\n  palette = c(\"orange\",\"navy\"),\n  domain = georef_zat$INTDENS\n)\n\nzat_label2 &lt;- glue(\"ZAT{georef_zat$ZAT} Intersection density: {round(georef_zat$INTDENS,2)}/km2\")\n\ngeoref_zat %&gt;%\n  st_zm() %&gt;%\n  st_transform(crs = st_crs(\"+proj=longlat +datum=WGS84\")) %&gt;%\n  leaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Voyager)  %&gt;%\n  addPolygons(color = \"white\", \n              weight = 0.5,\n              smoothFactor = 0.5,\n              opacity = 1,\n              fillColor = ~pal2(INTDENS),\n              fillOpacity = 0.8,\n              highlightOptions = highlightOptions(\n                weight = 5,\n                color = \"#666\",\n                fillOpacity = 0.8,\n                bringToFront = TRUE),\n              label = zat_label2,\n              labelOptions = labelOptions(\n                style = list(\n                  \"font-family\" = \"Fira Sans, sans-serif\",\n                  \"font-size\" = \"1.2em\"\n                ))\n              ) %&gt;% \n  addLegend(\"bottomleft\",\n            pal = pal2,\n            values = ~INTDENS,\n            title = \"Intersection Density in Bogotá&lt;/br&gt;(ZAT-level)\",\n            opacity = 1)\n\n\n\n\n\n\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(onroad)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\")+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators related to Features on the Road\") +\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(byroad)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\", alpha = 0.7)+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators related to Features by the Road\") +\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\n\n\nTraffic lights\n\n\nCode\npal3 &lt;- colorNumeric(\n  palette = c(\"orange\",\"navy\"),\n  domain = georef_zat$NUMTTFLIGH\n)\n\nzat_label3 &lt;- glue(\"ZAT{georef_zat$ZAT} Total traffic lights: {georef_zat$NUMTTFLIGH}\")\n\ngeoref_zat %&gt;%\n  st_zm() %&gt;%\n  st_transform(crs = st_crs(\"+proj=longlat +datum=WGS84\")) %&gt;%\n  leaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Voyager)  %&gt;%\n  addPolygons(color = \"white\", \n              weight = 0.5,\n              smoothFactor = 0.5,\n              opacity = 1,\n              fillColor = ~pal3(NUMTTFLIGH),\n              fillOpacity = 0.8,\n              highlightOptions = highlightOptions(\n                weight = 5,\n                color = \"#666\",\n                fillOpacity = 0.8,\n                bringToFront = TRUE),\n              label = zat_label3,\n              labelOptions = labelOptions(\n                style = list(\n                  \"font-family\" = \"Fira Sans, sans-serif\",\n                  \"font-size\" = \"1.2em\"\n                ))\n              ) %&gt;% \n  addLegend(\"bottomleft\",\n            pal = pal3,\n            values = ~NUMTTFLIGH,\n            title = \"Total Traffic Lights in Bogotá&lt;/br&gt;(ZAT-level)\",\n            opacity = 1)\n\n\n\n\n\n\n\n\nCode\nzat_data_long %&gt;% \n  filter(indicator%in%all_of(tlight)) %&gt;% \n  ggplot(aes(x=value)) +\n           geom_histogram(fill = \"skyblue\", color = \"blue\", alpha = 0.7)+\n           facet_wrap(~indicator, scales = \"free\") +\n           theme_minimal()+\n  labs(title = \"Distribution of Indicators about Traffic Lights\") +\n  theme(\n    strip.background = element_rect(fill = \"#dadada\", color = \"white\"),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(size = 15, face = \"bold\")\n  )\n\n\n\n\n\nInitial takeaway: some of the indicators seem to show similar spatial patterns, though there is a significant number of lower count values in the dataset which might make the visualization less clear."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BEPIDL-Notes",
    "section": "",
    "text": "Street Level Variables\n\n\nPart 1: Road Infrastructure\n\n\n\n\n\n\n\n\n\nJan 29, 2024\n\n\nHeli Xu\n\n\n\n\n\n\n  \n\n\n\n\nExploratory Data Analysis of BEPIDL Data\n\n\nGeo-referenced ZAT-level Indicators\n\n\n\n\n\n\n\n\n\nJan 23, 2024\n\n\nHeli Xu\n\n\n\n\n\n\n  \n\n\n\n\nInitial Look into BEPIDL Data\n\n\nZAT and Street Level\n\n\n\n\n\n\n\n\n\nJan 17, 2024\n\n\nHeli Xu\n\n\n\n\n\n\nNo matching items"
  }
]